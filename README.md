# ChuckieHelper

<div align="center">

**åŸºäº .NET 8 çš„ Web åå°ç®¡ç†ä¸è¿œç¨‹æ§åˆ¶æœåŠ¡**

[![.NET](https://img.shields.io/badge/.NET-8.0-512BD4?style=flat-square&logo=dotnet)](https://dotnet.microsoft.com/)
[![License](https://img.shields.io/badge/License-MIT-green?style=flat-square)](LICENSE)
[![Platform](https://img.shields.io/badge/Platform-Windows-0078D6?style=flat-square&logo=windows)](https://www.microsoft.com/windows)
[![Platform](https://img.shields.io/badge/Platform-Linux-FCC624?style=flat-square&logo=linux)](https://www.linux.org/)

</div>

---

## ğŸ–¥ï¸ ç³»ç»Ÿæ”¯æŒ

æœ¬é¡¹ç›®æ”¯æŒ Windows å’Œ Linux æ“ä½œç³»ç»Ÿã€‚



## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ–¥ï¸ **ç³»ç»Ÿæ§åˆ¶** - å®æ—¶ç›‘æ§ CPUã€å†…å­˜ã€ç£ç›˜ã€æ˜¾å¡ç­‰ç¡¬ä»¶ä¿¡æ¯<sup>Windows/Linux</sup>ï¼›æ”¯æŒé”å®šã€ç¡çœ ã€ä¼‘çœ ã€å…³æœºæ“ä½œ <sup>ğŸªŸ Windows</sup>
- ğŸ“Š **è¿›ç¨‹ç®¡ç†** - æŸ¥çœ‹å’Œç®¡ç†ç³»ç»Ÿè¿›ç¨‹ï¼Œæ”¯æŒæŒ‰ç±»å‹ç­›é€‰å’Œç»ˆæ­¢è¿›ç¨‹ 
- ğŸ® **è¿œç¨‹æ§åˆ¶** - å®æ—¶è¿œç¨‹æ¡Œé¢æ§åˆ¶ï¼Œæ”¯æŒ H.264 ç¼–ç ï¼Œå¯è°ƒèŠ‚åˆ†è¾¨ç‡å’Œç”»è´¨ <sup>ğŸªŸ Windows</sup>
- ğŸ’» **å‘½ä»¤ç»ˆç«¯** - WebSocket è¿œç¨‹ç»ˆç«¯ï¼Œæ”¯æŒ PowerShell/CMD <sup>ğŸªŸ Windows</sup>ï¼Œæ”¯æŒShell <sup>ğŸ§ Linux</sup>
- ğŸ³ **å®¹å™¨ç®¡ç†** - Docker å®¹å™¨çš„å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤å’Œæ—¥å¿—æŸ¥çœ‹ 
- ğŸ“ **Compose ç¼–è¾‘** - Docker Compose æ–‡ä»¶çš„åœ¨çº¿ç¼–è¾‘ã€éªŒè¯å’Œä¸€é”®éƒ¨ç½² 
- ğŸ“ **æ–‡ä»¶ç®¡ç†** - è¿œç¨‹æ–‡ä»¶æµè§ˆã€ä¸Šä¼ ã€ä¸‹è½½å’Œåˆ é™¤ 
- â° **ä»»åŠ¡è°ƒåº¦** - Hangfire çš„å®šæ—¶ä»»åŠ¡ç®¡ç†ï¼Œè‡ªè¡Œæ·»åŠ ä»»ä½•ä»»åŠ¡ (å†…ç½®qBittorrentç®¡ç†ã€DDNS ç­‰ä»»åŠ¡æ¨¡æ¿)
- ğŸ” **å®‰å…¨è®¤è¯** - JWT è®¤è¯ä¿æŠ¤æ‰€æœ‰æ•æ„Ÿæ“ä½œ 

---

## ğŸ“¸ ç•Œé¢é¢„è§ˆ

<details>
<summary><b>ç‚¹å‡»å±•å¼€åŠŸèƒ½æˆªå›¾</b></summary>

### ç³»ç»Ÿæ§åˆ¶

å®æ—¶ç›‘æ§ç³»ç»Ÿç¡¬ä»¶ä¿¡æ¯ï¼Œä¸€é”®æ‰§è¡Œç”µæºæ“ä½œã€‚

![ç³»ç»Ÿæ§åˆ¶ç•Œé¢](screenshots/QQ20260209-151205.png)

### è¿›ç¨‹ç®¡ç†

æŸ¥çœ‹æ‰€æœ‰è¿è¡Œä¸­çš„è¿›ç¨‹ï¼Œæ”¯æŒç­›é€‰å’Œç»ˆæ­¢æ“ä½œã€‚

![è¿›ç¨‹ç®¡ç†ç•Œé¢](screenshots/QQ20260209-151239.png)

### è¿œç¨‹æ§åˆ¶

å®æ—¶è¿œç¨‹æ¡Œé¢ï¼Œæ”¯æŒ H.264 è§†é¢‘æµï¼Œä½å»¶è¿Ÿé«˜ç”»è´¨ã€‚

![è¿œç¨‹æ§åˆ¶ç•Œé¢](screenshots/QQ20260209-151344.png)

### å‘½ä»¤ç»ˆç«¯

WebSocket è¿œç¨‹ç»ˆç«¯ï¼Œæ”¯æŒ PowerShell å’Œ CMDã€‚

![å‘½ä»¤ç»ˆç«¯ç•Œé¢](screenshots/QQ20260209-151405.png)

### å®¹å™¨ç®¡ç†

ç®¡ç† Docker å®¹å™¨çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸã€‚

![å®¹å™¨ç®¡ç†ç•Œé¢](screenshots/QQ20260209-151413.png)

### Docker Compose

åœ¨çº¿ç¼–è¾‘å’Œéƒ¨ç½² Docker Compose é¡¹ç›®ã€‚

![Compose ç¼–è¾‘å™¨](screenshots/QQ20260209-151449.png)

### æ–‡ä»¶ç®¡ç†

è¿œç¨‹æµè§ˆå’Œç®¡ç†æœåŠ¡å™¨æ–‡ä»¶ã€‚

![æ–‡ä»¶ç®¡ç†ç•Œé¢](screenshots/QQ20260209-151459.png)

</details>

---

## ğŸš€ å¿«é€Ÿå¼€å§‹



### ç¯å¢ƒè¦æ±‚

- ğŸªŸ Windows 10/11 æˆ– Windows Server
- ğŸ§ ä»»ä½•å¯è¿è¡Œ .NET 8 çš„ Linux æ“ä½œç³»ç»Ÿ
- [.NET 8 SDK/Runtime](https://dotnet.microsoft.com/download/dotnet/8.0)
- ï¼ˆå¯é€‰ï¼Œä»…Windowsï¼‰IIS + ASP.NET Core Hosting Bundle<sup>ğŸªŸ Windows</sup>

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**

```bash
git clone https://github.com/bighamx/chuckieTool.git
cd chuckieTool
```

2. **é…ç½®åº”ç”¨**

```bash
# å¤åˆ¶ç¤ºä¾‹é…ç½®æ–‡ä»¶
copy WebApplication1\appsettings.example.json WebApplication1\appsettings.json
```

ç¼–è¾‘ `appsettings.json`ï¼Œé…ç½®å¿…è¦çš„å‚æ•°ï¼š

```json
{
  "Auth": {
    "Username": "ä½ çš„ç”¨æˆ·å",
    "Password": "ä½ çš„å¯†ç ",
    "JwtSecret": "è‡³å°‘32ä½çš„éšæœºå¯†é’¥"
  }
}
```

3. **è¿è¡Œåº”ç”¨**

```bash
cd WebApplication1
dotnet run
```

4. **è®¿é—®æœåŠ¡**

- ä¸»é¡µï¼š`http://localhost:5104/`
- Hangfire é¢æ¿ï¼š`http://localhost:5104/hangfire`

---

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€é…ç½®

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `Auth:Username` | ç™»å½•ç”¨æˆ·å | `admin` |
| `Auth:Password` | ç™»å½•å¯†ç ï¼ˆå¿…å¡«ï¼‰ | `YourSecurePassword` |
| `Auth:JwtSecret` | JWT ç­¾åå¯†é’¥ï¼ˆå¿…å¡«ï¼Œâ‰¥32ä½ï¼‰ | `YourSecretKey...` |

### å¯é€‰é…ç½®

<details>
<summary><b>qBittorrent è®¾ç½®</b></summary>

```json
{
  "QbSettings": {
    "DefaultDockerUrl": "http://user:pass@host:port",
    "DefaultHomeUrl": "http://user:pass@host:port"
  }
}
```

</details>

<details>
<summary><b>Cloudflare DDNS è®¾ç½®</b></summary>

```json
{
  "CloudflareSettings": {
    "ApiToken": "YOUR_API_TOKEN",
    "ZoneId": "YOUR_ZONE_ID",
    "RecordName": "your.domain.com",
    "Proxied": false,
    "Ttl": 1800
  }
}
```

</details>

<details>
<summary><b>è¿œç¨‹æ§åˆ¶ææƒä»£ç†</b></summary>

ç”¨äºåœ¨ IIS/Session 0 ç¯å¢ƒä¸‹æ‰§è¡Œéœ€è¦æ¡Œé¢äº¤äº’çš„æ“ä½œï¼š

```json
{
  "RemoteControl": {
    "ElevatedAgent": {
      "UserName": "ç®¡ç†å‘˜ç”¨æˆ·å",
      "Password": "ç®¡ç†å‘˜å¯†ç ",
      "Domain": "å¯é€‰ï¼ŒåŸŸå"
    }
  }
}
```

æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼š`REMOTECONTROL_ELEVATEDAGENT_PASSWORD`

</details>

---

## ğŸ–¥ï¸ éƒ¨ç½²æ–¹å¼

### æ–¹å¼ä¸€ï¼šè‡ªå®¿ä¸»è¿è¡Œï¼ˆæ¨èç”¨äºå¼€å‘/æµ‹è¯•ï¼‰<sup>ğŸªŸ Windows/ğŸ§ Linux</sup>

```bash
# å¼€å‘æ¨¡å¼
dotnet run --project WebApplication1/ChuckieHelper.WebApi.csproj

# å‘å¸ƒåè¿è¡Œ
dotnet publish -c Release -o publish
cd publish
ChuckieHelper.WebApi.exe
```

### æ–¹å¼äºŒï¼šIIS éƒ¨ç½²ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰<sup>ğŸªŸ ä»…Windows</sup>

#### æ­¥éª¤ 1ï¼šå®‰è£…å¿…è¦ç»„ä»¶

1. **å¯ç”¨ IIS**
   - æ‰“å¼€ã€Œæ§åˆ¶é¢æ¿ã€â†’ã€Œç¨‹åºã€â†’ã€Œå¯ç”¨æˆ–å…³é—­ Windows åŠŸèƒ½ã€
   - å‹¾é€‰ä»¥ä¸‹é¡¹ç›®ï¼š
     - âœ… **Internet Information Services**
     - âœ… **Web ç®¡ç†å·¥å…·** â†’ **IIS ç®¡ç†æ§åˆ¶å°**
     - âœ… **ä¸‡ç»´ç½‘æœåŠ¡** â†’ **åº”ç”¨ç¨‹åºå¼€å‘åŠŸèƒ½** â†’ **ASP.NET 4.8**
     - âœ… **ä¸‡ç»´ç½‘æœåŠ¡** â†’ **å¸¸è§ HTTP åŠŸèƒ½**ï¼ˆå…¨éƒ¨å‹¾é€‰ï¼‰

2. **å®‰è£… ASP.NET Core Hosting Bundle**
   - ä¸‹è½½ [.NET 8 Hosting Bundle](https://dotnet.microsoft.com/download/dotnet/8.0)
   - è¿è¡Œå®‰è£…ç¨‹åºï¼Œå®‰è£…å®Œæˆå**é‡å¯ IIS**ï¼ˆæˆ–é‡å¯ç”µè„‘ï¼‰

#### æ­¥éª¤ 2ï¼šå‘å¸ƒåº”ç”¨

```bash
dotnet publish WebApplication1/ChuckieHelper.WebApi.csproj -c Release -o C:\inetpub\ChuckieHelper
```

> ğŸ“ å‘å¸ƒåï¼Œå°†ä½ çš„ `appsettings.json` å¤åˆ¶åˆ° `C:\inetpub\ChuckieHelper` ç›®å½•

#### æ­¥éª¤ 3ï¼šåˆ›å»ºåº”ç”¨ç¨‹åºæ± 

1. æ‰“å¼€ã€ŒIIS ç®¡ç†å™¨ã€ï¼ˆè¿è¡Œ `inetmgr`ï¼‰
2. å³é”®ã€Œåº”ç”¨ç¨‹åºæ± ã€â†’ã€Œæ·»åŠ åº”ç”¨ç¨‹åºæ± ã€
   - **åç§°**ï¼š`ChuckieHelperPool`
   - **.NET CLR ç‰ˆæœ¬**ï¼š`æ— æ‰˜ç®¡ä»£ç `
   - **æ‰˜ç®¡ç®¡é“æ¨¡å¼**ï¼š`é›†æˆ`
3. ç‚¹å‡»ã€Œç¡®å®šã€åˆ›å»º

#### æ­¥éª¤ 4ï¼šé…ç½® LocalSystem èº«ä»½ï¼ˆé‡è¦ï¼ï¼‰

> âš ï¸ **ä»…åœ¨éœ€è¦è¿œç¨‹æ§åˆ¶åŠŸèƒ½æ—¶é…ç½®**ã€‚LocalSystem å…·æœ‰æœ€é«˜æƒé™ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚

1. åœ¨ã€Œåº”ç”¨ç¨‹åºæ± ã€ä¸­æ‰¾åˆ° `ChuckieHelperPool`
2. å³é”® â†’ã€Œé«˜çº§è®¾ç½®ã€
3. æ‰¾åˆ°ã€Œè¿›ç¨‹æ¨¡å‹ã€â†’ã€Œæ ‡è¯†ã€ï¼Œç‚¹å‡»å³ä¾§çš„ `...` æŒ‰é’®
4. é€‰æ‹©ã€Œå†…ç½®å¸æˆ·ã€â†’ ä¸‹æ‹‰é€‰æ‹© **LocalSystem**
5. ç‚¹å‡»ã€Œç¡®å®šã€ä¿å­˜



#### æ­¥éª¤ 5ï¼šåˆ›å»ºç½‘ç«™

1. åœ¨ IIS ç®¡ç†å™¨ä¸­ï¼Œå³é”®ã€Œç½‘ç«™ã€â†’ã€Œæ·»åŠ ç½‘ç«™ã€
2. é…ç½®å¦‚ä¸‹ï¼š
   - **ç«™ç‚¹åç§°**ï¼š`ChuckieHelper`
   - **åº”ç”¨ç¨‹åºæ± **ï¼šé€‰æ‹© `ChuckieHelperPool`
   - **ç‰©ç†è·¯å¾„**ï¼š`C:\inetpub\ChuckieHelper`
   - **ç»‘å®š**ï¼š
     - ç±»å‹ï¼š`http`ï¼ˆæˆ– `https`ï¼‰
     - IP åœ°å€ï¼š`å…¨éƒ¨æœªåˆ†é…`
     - ç«¯å£ï¼š`5104`ï¼ˆæˆ–ä½ å¸Œæœ›çš„ç«¯å£ï¼‰
3. ç‚¹å‡»ã€Œç¡®å®šã€åˆ›å»º

#### æ­¥éª¤ 6ï¼šéªŒè¯éƒ¨ç½²

1. å¯åŠ¨ç½‘ç«™ï¼ˆå³é”®ç½‘ç«™ â†’ã€Œç®¡ç†ç½‘ç«™ã€â†’ã€Œå¯åŠ¨ã€ï¼‰
2. æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:5104/`
3. ä½¿ç”¨ `appsettings.json` ä¸­é…ç½®çš„è´¦å·å¯†ç ç™»å½•

#### å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|----------|
| 502.5 é”™è¯¯ | æ£€æŸ¥ Hosting Bundle æ˜¯å¦æ­£ç¡®å®‰è£…ï¼Œå°è¯•é‡å¯ IIS |
| 500 é”™è¯¯ | æ£€æŸ¥ `appsettings.json` æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡® |
| æƒé™ä¸è¶³ | ç¡®è®¤åº”ç”¨ç¨‹åºæ± ä½¿ç”¨ LocalSystem èº«ä»½è¿è¡Œ |
| ç«¯å£è¢«å ç”¨ | æ›´æ¢ç«¯å£æˆ–åœæ­¢å ç”¨ç«¯å£çš„æœåŠ¡ |

> âš ï¸ **å®‰å…¨æç¤º**ï¼š`appsettings.json` åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œè¯·å‹¿æäº¤åˆ°å…¬å¼€ä»“åº“ï¼

---

## ğŸ”§ æ¡Œé¢ä»£ç† <sup>ğŸªŸ ä»…Windows</sup>

åœ¨ IIS/Session 0 ç¯å¢ƒä¸‹ï¼Œè¿œç¨‹æ§åˆ¶åŠŸèƒ½éœ€è¦æ¡Œé¢ä»£ç†çš„æ”¯æŒæ‰èƒ½å’Œç”¨æˆ·æ¡Œé¢è¿›è¡Œäº¤äº’ã€‚

æ¡Œé¢ä»£ç†è¿›ç¨‹ä¼šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œåˆ›å»ºæ¡Œé¢ä»£ç†è¿›ç¨‹æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨**å¤åˆ¶å·²æœ‰ç®¡ç†å‘˜ä»¤ç‰Œ**çš„æ–¹å¼ï¼Œè‹¥æ— åˆ™ä¾èµ–**è®¡åˆ’ä»»åŠ¡**ï¼š

1. **å¤åˆ¶å·²æœ‰ç®¡ç†å‘˜ä»¤ç‰Œ**ï¼šåœ¨å½“å‰äº¤äº’ä¼šè¯ä¸­æŸ¥æ‰¾å·²å­˜åœ¨çš„é«˜å®Œæ•´æ€§è¿›ç¨‹ï¼ˆå¦‚ç”¨æˆ·æ›¾ä»¥ç®¡ç†å‘˜è¿è¡Œè¿‡ä»»åŠ¡ç®¡ç†å™¨ç­‰ï¼‰ï¼Œå¤åˆ¶å…¶ä»¤ç‰Œå¹¶ç”¨äºå¯åŠ¨ä»£ç†ï¼Œæ— éœ€é…ç½®å¯†ç ï¼Œå³æ—¶ç”Ÿæ•ˆã€‚
2. **è®¡åˆ’ä»»åŠ¡**ï¼šè‹¥æœªæ‰¾åˆ°é«˜å®Œæ•´æ€§ä»¤ç‰Œï¼Œä¸”å·²é…ç½® `RemoteControl:ElevatedAgent`ï¼ˆç®¡ç†å‘˜ç”¨æˆ·åä¸å¯†ç ï¼‰ï¼Œåº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºâ€œç™»å½•æ—¶ä»¥æœ€é«˜æƒé™è¿è¡Œâ€çš„è®¡åˆ’ä»»åŠ¡ï¼Œç”¨æˆ·**æ³¨é”€å¹¶é‡æ–°ç™»å½•**åï¼Œæ¡Œé¢ä»£ç†å°†ä»¥ç®¡ç†å‘˜èº«ä»½è‡ªåŠ¨å¯åŠ¨ã€‚
3. ä»£ç†é€šè¿‡å‘½åç®¡é“ä¸ WebApi é€šä¿¡ï¼Œæ‰§è¡Œé”®é¼ è¾“å…¥ç­‰æ¡Œé¢æ“ä½œã€‚


æ‰‹åŠ¨è¿è¡Œæ¡Œé¢ä»£ç†æ¨¡å¼ï¼š

```bash
dotnet ChuckieHelper.WebApi.dll --desktop-agent
```

> âš ï¸ æ¡Œé¢ä»£ç†ä»…æ”¯æŒ Windowsï¼ŒLinux æ— éœ€æ­¤åŠŸèƒ½ã€‚

---

## â“ å¸¸è§é—®é¢˜

<details>
<summary><b>Q: è®¿é—®å‡ºç° 500/502 é”™è¯¯ï¼Ÿ</b></summary>

- æ£€æŸ¥ `appsettings.json` æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
- ç¡®è®¤å·²å®‰è£… .NET 8 Hosting Bundle
- æŸ¥çœ‹ Windows äº‹ä»¶æŸ¥çœ‹å™¨ä¸­çš„é”™è¯¯æ—¥å¿—

</details>

<details>
<summary><b>Q: Hangfire é¢æ¿æ— æ³•è®¿é—®ï¼Ÿ</b></summary>

- ç¡®è®¤å·²ä½¿ç”¨æ­£ç¡®çš„è´¦å·å¯†ç ç™»å½•
- æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦é˜»æ­¢äº† Cookie

</details>

<details>
<summary><b>Q: è¿œç¨‹æ§åˆ¶åŠŸèƒ½æ— æ³•ä½¿ç”¨ï¼Ÿ</b></summary>

- ç¡®è®¤åº”ç”¨ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œ
- åœ¨ IIS éƒ¨ç½²æ—¶ï¼Œæ£€æŸ¥åº”ç”¨æ± æ˜¯å¦é…ç½®ä¸º `LocalSystem`
- éªŒè¯ `RemoteControl:ElevatedAgent` é…ç½®æ˜¯å¦æ­£ç¡®

</details>

---

## ğŸ“ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT åè®®](LICENSE) å¼€æºã€‚

---

## ğŸ™ è‡´è°¢

- [ASP.NET Core](https://github.com/dotnet/aspnetcore)
- [Hangfire](https://github.com/HangfireIO/Hangfire)
